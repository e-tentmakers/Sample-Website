<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>문의하기 - 샘플교회</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <a href="index.html">
                    <img src="Image files/Cross Icon.jpg" alt="Logo" class="logo-img">
                    샘플교회
                </a>
            </div>
            <ul class="nav-menu">
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link">About</a>
                    <ul class="dropdown-menu">
                        <li><a href="pages/about/vision.html">교회비전</a></li>
                        <li><a href="pages/about/greeting.html">인사말</a></li>
                        <li><a href="pages/about/staff.html">섬기는 사람들</a></li>
                        <li><a href="pages/about/location.html">오시는길</a></li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link">Worship</a>
                    <ul class="dropdown-menu">
                        <li><a href="pages/worship/sunday.html">주일예배</a></li>
                        <li><a href="pages/worship/dawn.html">새벽기도</a></li>
                        <li><a href="pages/worship/wednesday.html">수요예배</a></li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link">Care</a>
                    <ul class="dropdown-menu">
                        <li><a href="pages/care/newcomer.html">새가족 안내</a></li>
                        <li><a href="pages/care/oneonone.html">일대일 훈련</a></li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link">Community</a>
                    <ul class="dropdown-menu">
                        <li><a href="pages/community/toddler.html">영유아/유치부</a></li>
                        <li><a href="pages/community/elementary.html">초등부</a></li>
                        <li><a href="pages/community/youth.html">중고등부</a></li>
                        <li><a href="pages/community/college.html">대학청년부</a></li>
                        <li><a href="pages/community/adult.html">성인부</a></li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link">Board</a>
                    <ul class="dropdown-menu">
                        <li><a href="pages/board/news.html">교회소식</a></li>
                        <li><a href="pages/board/notice.html">게시판</a></li>
                        <li><a href="pages/board/bulletin.html">주보</a></li>
                        <li><a href="pages/board/resources.html">자료실</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="contact.html" class="nav-link contact-btn">문의하기</a>
                </li>
            </ul>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Contact Form Section -->
    <section class="page-section">
        <div class="container">
            <h1 class="page-title">문의하기</h1>
            <div class="contact-form-container">
                <!-- 
                    FORMPREE SETUP INSTRUCTIONS:
                    1. Go to https://formspree.io and login with: miyoung@alumni.cmu.edu
                    2. Click "New Form" or select an existing form
                    3. In the Integration tab, find "Your form's endpoint is:"
                    4. Copy the form ID from the URL (e.g., https://formspree.io/f/YOUR_FORM_ID)
                    5. Replace "YOUR_FORM_ID_HERE" below with your actual form ID
                    6. Set the recipient email in Formspree settings to: my_yoo@hotmail.com
                -->
                <form id="contact-form" action="https://formspree.io/f/manbkqwl" method="POST">
                    <input type="hidden" name="_subject" value="샘플교회 문의하기">
                    <input type="hidden" name="_next" value="?success=true">
                    <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off">
                    
                    <div class="form-group">
                        <label for="name">성함</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">이메일</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="subject">제목</label>
                        <input type="text" id="subject" name="subject" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="message">문의 내용</label>
                        <textarea id="message" name="message" rows="6" required></textarea>
                    </div>
                    
                    <button type="submit" class="submit-btn" id="submit-btn">보내기</button>
                </form>
                
                <div id="success-message" class="success-message" style="display: none;">
                    OO교회로 문의해 주셔서 감사합니다. 확인 후 회신 드리겠습니다.
                </div>
                
                <div id="error-message" class="error-message" style="display: none;">
                    <p>오류가 발생했습니다. 다시 시도해주세요.</p>
                    <p style="font-size: 14px; margin-top: 10px; color: #666;">만약 문제가 계속되면, 이메일로 직접 문의해주세요: samplechurch@gmail.com</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>연락처</h3>
                    <p>주소: 경기도</p>
                    <p>TEL: 031-000-0000</p>
                    <p>E-mail: samplechurch@gmail.com</p>
                </div>
                <div class="footer-section">
                    <h3>샘플교회 온라인헌금</h3>
                    <p>십일조헌금: 하나은행 000-000000-000000</p>
                    <p>주일헌금: 하나은행 000-000000-000000</p>
                    <p>감사헌금: 하나은행 000-000000-000000</p>
                    <p>특별헌금: 하나은행 000-000000-000000</p>
                    <p>건축헌금: 하나은행 000-000000-000000</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 샘플교회. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="js/script.js"></script>
    <script>
        // Check for success/error in URL parameters (for redirect-based submission)
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('success') === 'true') {
            document.getElementById('contact-form').style.display = 'none';
            document.getElementById('success-message').style.display = 'block';
        }
        
        // Handle form submission with improved error handling
        const form = document.getElementById('contact-form');
        if (form) {
            form.addEventListener('submit', function(e) {
                // Only prevent default if JavaScript is working
                // Otherwise, let the form submit normally (fallback)
                e.preventDefault();
                
                const submitBtn = document.getElementById('submit-btn');
                const successMsg = document.getElementById('success-message');
                const errorMsg = document.getElementById('error-message');
                const formData = new FormData(form);
                
                // Hide previous messages
                successMsg.style.display = 'none';
                errorMsg.style.display = 'none';
                
                // Disable submit button to prevent double submission
                submitBtn.disabled = true;
                submitBtn.textContent = '전송 중...';
                
                // Submit to Formspree
                fetch(form.action, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    },
                    mode: 'cors'
                })
                .then(response => {
                    if (response.ok) {
                        // Success - hide form and show success message
                        form.style.display = 'none';
                        successMsg.style.display = 'block';
                        // Clear form fields
                        form.reset();
                    } else {
                        // Try to get error details
                        return response.json().then(data => {
                            console.error('Formspree error:', data);
                            form.style.display = 'block';
                            errorMsg.style.display = 'block';
                            submitBtn.disabled = false;
                            submitBtn.textContent = '보내기';
                            
                            // If it's a form ID error, provide helpful message
                            if (response.status === 404 || response.status === 400) {
                                errorMsg.innerHTML = '<p><strong>폼 설정 오류가 발생했습니다.</strong></p><p style="font-size: 14px; margin-top: 10px; color: #666;">Formspree 폼 ID가 올바르지 않습니다. <br><br><strong>해결 방법:</strong><br>1. https://formspree.io 에 로그인 (miyoung@alumni.cmu.edu)<br>2. 새 폼 생성 또는 기존 폼 선택<br>3. Integration 탭에서 폼 ID 확인<br>4. contact.html 파일의 "YOUR_FORM_ID_HERE"를 실제 폼 ID로 교체<br><br>자세한 내용은 FORMPREE_SETUP.md 파일을 참고하세요.</p>';
                            }
                        }).catch(() => {
                            // If JSON parsing fails, still show error
                            form.style.display = 'block';
                            errorMsg.style.display = 'block';
                            submitBtn.disabled = false;
                            submitBtn.textContent = '보내기';
                        });
                    }
                })
                .catch(error => {
                    console.error('Network error:', error);
                    // Show error message with helpful information
                    form.style.display = 'block';
                    errorMsg.style.display = 'block';
                    errorMsg.innerHTML = '<p><strong>네트워크 오류가 발생했습니다.</strong></p><p style="font-size: 14px; margin-top: 10px; color: #666;">보안 소프트웨어가 요청을 차단했을 수 있습니다. 이메일로 직접 문의해주세요: samplechurch@gmail.com</p>';
                    submitBtn.disabled = false;
                    submitBtn.textContent = '보내기';
                });
            });
        }
    </script>
</body>
</html>
